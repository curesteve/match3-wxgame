# 三消游戏 - 阶段四（微信小游戏）

阶段一 MVP：交换 → 三连消除 → 下落填充 → 连消。  
**阶段四**：糖果风色块、果冻弹性下落、炫酷消除（粒子/闪光/COMBO）、音效、四连直线消除器与五连/相交 3×3 炸弹。  
**阶段二**：计分、步数限制、多关卡配置，胜利/失败与下一关、重试。  
**阶段三**：多目标（分数 + 收集指定颜色宝石）、全部达成过关；墙格、冰块。

## 运行方式

1. 安装 [微信开发者工具](https://developers.weixin.qq.com/minigame/dev/devtools/download.html)。
2. 打开微信开发者工具，选择「小游戏」→「导入项目」。
3. 项目目录选择本文件夹（`match3-wxgame`）。
4. AppID 可先使用「测试号」或「游客模式」。
5. 编译后在模拟器或真机预览中运行。

## 操作说明

- **滑动交换**：在一个格子上按下，滑到**相邻**格子（上下左右）后松手，即完成交换（无效交换会自动回退）。
- 交换后若产生三连或更多连，会播放**消除动画**（缩小淡出）→ **下落动画** → **新块从顶部落入**，并继续连消直到稳定。
- 色块为**糖果风**圆角块（糖衣高光），下落带**果冻弹性**（overshoot + 落地挤压），消除有**粒子飞散/闪光/COMBO 文字**。
- **四连**生成横/竖直线消除器，**五连或 L/T 相交**生成 3×3 炸弹；消除/下落/填充过程中无法操作。

## 项目结构

- `game.js`：入口与全部游戏逻辑（网格、检测、交换、消除、下落、绘制、触摸）。
- `game.json`：小游戏配置（竖屏、是否显示状态栏等）。
- `project.config.json`：微信开发者工具项目配置。
- `开发计划.md`：三消游戏迭代开发计划（阶段一至六、任务拆分与微信小游戏适配说明）。
- `sounds/`：音效目录，放入 swap.mp3、eliminate.mp3、combo.mp3、win.mp3、fail.mp3 即可播放（可选）。

## 技术说明

- 画布：`wx.createCanvas()`，尺寸取窗口宽高，网格居中绘制，格子大小 = `min(宽,高)/8`。
- 触摸：`wx.onTouchEnd`，用 `changedTouches[0].clientX/clientY` 换算到格子坐标。
- 无 DOM/BOM，渲染仅用 Canvas 2D API；`roundRect` 若不存在则回退为 `fillRect`。
